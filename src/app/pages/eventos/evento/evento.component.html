
<div class="container" *ngIf="evento">
    <p-toast></p-toast>
    <p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>

    <app-boton-back></app-boton-back>

    <div class="grid">

        <div class="col-4 text-center">
            <p-card>
                <h1>{{evento.busqueda}}</h1>
                <h2>{{evento.titulo}}</h2>

                <p>Etapa actual: {{evento.tareaNombre}}</p>
                <div class="progress">
                    <p-progressBar [value]="porcentajeAvance"></p-progressBar>
                </div>

                <p-divider></p-divider>

                <div class="grid">


                    <div class="col col-offset-2">

                        <div class="grid">
                            <div class="col-3">
                                <h4>Cliente:</h4>
                            </div>
                            <div class="col">
                                <p>{{evento.cliente.sigla}} - {{evento.cliente.nombre}}</p>
                            </div>
                        </div>

                        <div class="grid">
                            <div class="col-3">
                                <h4>Producto:</h4>
                            </div>
                            <div class="col">
                                <p>{{evento.producto.nombre}} | {{evento.producto.entorno}}</p>
                            </div>
                        </div>

                        <div class="grid">
                            <div class="col-3">
                                <h4>Usuario:</h4>
                            </div>
                            <div class="col">
                                <p>Actual: {{evento.usuarioActual.usuario}}</p>
                                <p>Alta: {{evento.usuarioAlta.usuario}}</p>
                            </div>
                        </div>

                    </div>

                </div>

            </p-card>
        </div>

        <div class="col-8 panel">
            <div class="card">
                <div class="card-body">
                    <p-tabView styleClass="tabview-custom">
                        <p-tabPanel>
                            <ng-template pTemplate="header">
                                <i class="pi pi-heart mr-1"></i>
                                <span>Vida</span>
                            </ng-template>
                            
                            <app-vida-evento [eventoId]="evento.id"></app-vida-evento>
                            <!-- <app-grafico-tipos origen="U" [filtro]="usuarioAVer"></app-grafico-tipos> -->

                        </p-tabPanel>


                        <p-tabPanel header="Documentos">
                            <ng-template pTemplate="header">
                                <i class="pi pi-copy mr-1"></i>
                                <span>Documentos</span>
                            </ng-template>
                            
                            
                            <p-table [value]="archivosAdjuntos" styleClass="p-datatable-sm">
                                <ng-template pTemplate="caption">
                                    <div class="flex align-items-center justify-content-between" style="display: flex;">
                                        <button pButton pRipple label="Agregar" icon="pi pi-plus" class="p-button-success botonChico" (click)="adjuntarDocumentos()"></button>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Tipo</th>
                                        <th></th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-file>
                                    <tr>
                                        <td>{{ file.nombre }}</td>
                                        <td>{{ file.tipo }}</td>
                                        <td>
                                            <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-success botonRedondoChico mr-2" (click)="verAdjunto(file)"></button>
                                            <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger botonRedondoChico" (click)="eliminarAdjunto(file)"></button>
                                        </td>
                                    </tr>
                                </ng-template>
                            </p-table>
                        </p-tabPanel>


                        <p-tabPanel header="Comentarios">
                            <ng-template pTemplate="header">
                                <i class="pi pi-comments mr-1"></i>
                                <span>Comentarios</span>
                            </ng-template>
                            
                            <div class="grid">
                                <div class="col-10">
                                    <ckeditor [editor]="Editor" [(ngModel)]="comentario"></ckeditor>
                                </div>
                                <div class="col-2">
                                    <button pButton type="submit" pRipple label="Comentar" class="p-button-success"style="margin-top:10px;" (click)="comentar(evento)"></button>
                                </div>
                            </div>

                            <ng-container *ngFor="let comentario of comentarios" class="mt-5">
                                <app-comentario [comentario]="comentario"></app-comentario>
                            </ng-container>

                        </p-tabPanel>


                    </p-tabView>
                </div>
            </div>
        </div>

    </div>



</div>